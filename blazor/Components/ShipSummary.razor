@namespace FT_Blazor.Components
@using FT_Blazor.Models
@using System.Text.Json;
@if (shipData is not null){
    <tr>
        <MudTd>@shipData.Name</MudTd>
        <MudTd>@shipData.CurrentSpeed</MudTd>
        <MudTd>@shipData.CurrentBearing</MudTd>
        <MudTd>(@shipData.X , @shipData.Y)</MudTd>
    </tr>
}

@code {
    [Parameter]
    public string ShipId { get; set; }

    private Ship shipData;
    string baseURL = "https://ft-functions.azurewebsites.net/api/";

    protected override async Task OnInitializedAsync()
    {
        await GetShip(ShipId);
    }

    private async Task GetShip(string ShipId)
    {
        string queryURL = baseURL + $"GetShip?id={ShipId}";
        HttpClient client = new HttpClient { BaseAddress = new Uri(queryURL) };

        HttpResponseMessage response = null;

        response = await client.GetAsync(client.BaseAddress);

        if (response.Content is object && response.Content.Headers.ContentType.MediaType == "application/json")
        {
            var content = await response.Content.ReadAsStringAsync();
            Ship shipResponse = JsonSerializer.Deserialize<Ship>(content, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
            shipData = shipResponse;
        }
    }
}
